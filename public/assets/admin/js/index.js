"use strict";function addTab(e){tab.tabAdd(e)}function donation(){layer.tab({area:["260px","367px"],tab:[{title:"微信",content:"<div style='padding:30px;overflow:hidden;background:#d2d0d0;'><img src='images/wechat.jpg'></div>"},{title:"支付宝",content:"<div style='padding:30px;overflow:hidden;background:#d2d0d0;'><img src='images/alipay.jpg'></div>"}]})}var $,tab,skyconsWeather;layui.config({base:"js/"}).use(["bodyTab","form","element","layer","jquery"],function(){function e(){var e=window.sessionStorage.getItem("skin");e&&("自定义"!=window.sessionStorage.getItem("skinValue")?$("body").addClass(window.sessionStorage.getItem("skin")):($(".layui-layout-admin .layui-header").css("background-color",e.split(",")[0]),$(".layui-bg-black").css("background-color",e.split(",")[1]),$(".hideMenu").css("background-color",e.split(",")[2])))}function i(){a.open({title:!1,type:1,content:'\t<div class="admin-header-lock" id="lock-box"><div class="admin-header-lock-img"><img src="images/face.jpg"/></div><div class="admin-header-lock-name" id="lockUserName">请叫我马哥</div><div class="input_btn"><input type="password" class="admin-header-lock-input layui-input" autocomplete="off" placeholder="请输入密码解锁.." name="lockPwd" id="lockPwd" /><button class="layui-btn" id="unlock">解锁</button></div><p>请输入“123456”，否则不会解锁成功哦！！！</p></div>',closeBtn:0,shade:.9}),$(".admin-header-lock-input").focus()}function t(){a.open({type:1,title:"系统公告",closeBtn:!1,area:"310px",shade:.8,id:"LAY_layuipro",btn:["火速围观"],moveType:1,content:'<div style="padding:15px 20px; text-align:justify; line-height: 22px; text-indent:2em;border-bottom:1px solid #e2e2e2;"><p>最近偶然发现贤心大神的layui框架，瞬间被他的完美样式所吸引，虽然功能不算强大，但毕竟是一个刚刚出现的框架，后面会慢慢完善的。很早之前就想做一套后台模版，但是感觉bootstrop代码的冗余太大，不是非常喜欢，自己写又太累，所以一直闲置了下来。直到遇到了layui我才又燃起了制作一套后台模版的斗志。由于本人只是纯前端，所以页面只是单纯的实现了效果，没有做服务器端的一些处理，可能后期技术跟上了会更新的，如果有什么问题欢迎大家指导。谢谢大家。</p><p>在此特别感谢Beginner和Paco，他们写的框架给了我很好的启发和借鉴。希望有时间可以多多请教。</p></div>',success:function(e){var i=e.find(".layui-layer-btn");i.css("text-align","center"),i.on("click",function(){window.sessionStorage.setItem("showNotice","true")}),$(window).width()>432&&i.on("click",function(){a.tips("系统公告躲在了这里","#showNotice",{tips:3})})}})}var n=layui.form(),a=layui.layer,o=layui.element();$=layui.jquery,tab=layui.bodyTab({openTabNum:"50",url:"json/navs.json"}),e(),$(".changeSkin").click(function(){a.open({title:"更换皮肤",area:["310px","280px"],type:"1",content:'<div class="skins_box"><form class="layui-form"><div class="layui-form-item"><input type="radio" name="skin" value="默认" title="默认" lay-filter="default" checked=""><input type="radio" name="skin" value="橙色" title="橙色" lay-filter="orange"><input type="radio" name="skin" value="蓝色" title="蓝色" lay-filter="blue"><input type="radio" name="skin" value="自定义" title="自定义" lay-filter="custom"><div class="skinCustom"><input type="text" class="layui-input topColor" name="topSkin" placeholder="顶部颜色" /><input type="text" class="layui-input leftColor" name="leftSkin" placeholder="左侧颜色" /><input type="text" class="layui-input menuColor" name="btnSkin" placeholder="顶部菜单按钮" /></div></div><div class="layui-form-item skinBtn"><a href="javascript:;" class="layui-btn layui-btn-small layui-btn-normal" lay-submit="" lay-filter="changeSkin">确定更换</a><a href="javascript:;" class="layui-btn layui-btn-small layui-btn-primary" lay-submit="" lay-filter="noChangeSkin">我再想想</a></div></form></div>',success:function(i,t){var o=window.sessionStorage.getItem("skin");window.sessionStorage.getItem("skinValue")&&$(".skins_box input[value="+window.sessionStorage.getItem("skinValue")+"]").attr("checked","checked"),$(".skins_box input[value=自定义]").attr("checked")&&($(".skinCustom").css("visibility","inherit"),$(".topColor").val(o.split(",")[0]),$(".leftColor").val(o.split(",")[1]),$(".menuColor").val(o.split(",")[2])),n.render(),$(".skins_box").removeClass("layui-hide"),$(".skins_box .layui-form-radio").on("click",function(){var e;"橙色"==$(this).find("span").text()?e="orange":"蓝色"==$(this).find("span").text()?e="blue":"默认"==$(this).find("span").text()&&(e=""),"自定义"!=$(this).find("span").text()?($(".topColor,.leftColor,.menuColor").val(""),$("body").removeAttr("class").addClass("main_body "+e),$(".skinCustom").removeAttr("style"),$(".layui-bg-black,.hideMenu,.layui-layout-admin .layui-header").removeAttr("style")):$(".skinCustom").css("visibility","inherit")});var s,l;$(".topColor").blur(function(){$(".layui-layout-admin .layui-header").css("background-color",$(this).val())}),$(".leftColor").blur(function(){$(".layui-bg-black").css("background-color",$(this).val())}),$(".menuColor").blur(function(){$(".hideMenu").css("background-color",$(this).val())}),n.on("submit(changeSkin)",function(e){"自定义"!=e.field.skin?("橙色"==e.field.skin?l="orange":"蓝色"==e.field.skin?l="blue":"默认"==e.field.skin&&(l=""),window.sessionStorage.setItem("skin",l)):(s=$(".topColor").val()+","+$(".leftColor").val()+","+$(".menuColor").val(),window.sessionStorage.setItem("skin",s),$("body").removeAttr("class").addClass("main_body")),window.sessionStorage.setItem("skinValue",e.field.skin),a.closeAll("page")}),n.on("submit(noChangeSkin)",function(){$("body").removeAttr("class").addClass("main_body "+window.sessionStorage.getItem("skin")),$(".layui-bg-black,.hideMenu,.layui-layout-admin .layui-header").removeAttr("style"),e(),a.closeAll("page")})},cancel:function(){$("body").removeAttr("class").addClass("main_body "+window.sessionStorage.getItem("skin")),$(".layui-bg-black,.hideMenu,.layui-layout-admin .layui-header").removeAttr("style"),e()}})}),$(".signOut").click(function(){window.sessionStorage.removeItem("menu"),menu=[],window.sessionStorage.removeItem("curmenu")}),$(".hideMenu").click(function(){$(".layui-layout-admin").toggleClass("showMenu"),tab.tabMove()}),tab.render(),$(".lockcms").on("click",function(){window.sessionStorage.setItem("lockcms",!0),i()}),"true"==window.sessionStorage.getItem("lockcms")&&i(),$("body").on("click","#unlock",function(){""==$(this).siblings(".admin-header-lock-input").val()?(a.msg("请输入解锁密码！"),$(this).siblings(".admin-header-lock-input").focus()):"123456"==$(this).siblings(".admin-header-lock-input").val()?(window.sessionStorage.setItem("lockcms",!1),$(this).siblings(".admin-header-lock-input").val(""),a.closeAll("page")):(a.msg("密码错误，请重新输入！"),$(this).siblings(".admin-header-lock-input").val("").focus())}),$(document).on("keydown",function(){13==event.keyCode&&$("#unlock").click()});var s=$(".site-tree-mobile"),l=$(".site-mobile-shade");if(s.on("click",function(){$("body").addClass("site-mobile")}),l.on("click",function(){$("body").removeClass("site-mobile")}),$("body").on("click",".layui-nav .layui-nav-item a",function(){$(this).attr("data-url")&&0==$(this).siblings().length&&(addTab($(this)),$("body").removeClass("site-mobile")),$(this).parent("li").siblings().removeClass("layui-nav-itemed")}),"true"!=window.sessionStorage.getItem("lockcms")&&"true"!=window.sessionStorage.getItem("showNotice")&&t(),$(".showNotice").on("click",function(){t()}),null!=window.sessionStorage.getItem("menu")){menu=JSON.parse(window.sessionStorage.getItem("menu")),curmenu=window.sessionStorage.getItem("curmenu");for(var u="",c=0;c<menu.length;c++)u="",menu[c].icon&&("icon"==menu[c].icon.split("-")[0]?u+='<i class="iconfont '+menu[c].icon+'"></i>':u+='<i class="layui-icon">'+menu[c].icon+"</i>"),u+="<cite>"+menu[c].title+"</cite>",u+='<i class="layui-icon layui-unselect layui-tab-close" data-id="'+menu[c].layId+'">&#x1006;</i>',o.tabAdd("bodyTab",{title:u,content:"<iframe src='"+menu[c].href+"' data-id='"+menu[c].layId+"'></frame>",id:menu[c].layId}),"undefined"!=curmenu?""==curmenu||"null"==curmenu?o.tabChange("bodyTab",""):JSON.parse(curmenu).title==menu[c].title&&o.tabChange("bodyTab",menu[c].layId):o.tabChange("bodyTab",menu[menu.length-1].layId);tab.tabMove()}$(".closePageOther").on("click",function(){if($("#top_tabs li").length>2&&"后台首页"!=$("#top_tabs li.layui-this cite").text()){var e=JSON.parse(window.sessionStorage.getItem("menu"));$("#top_tabs li").each(function(){if(""!=$(this).attr("lay-id")&&!$(this).hasClass("layui-this")){o.tabDelete("bodyTab",$(this).attr("lay-id")).init();for(var i=0;i<e.length;i++)$("#top_tabs li.layui-this cite").text()==e[i].title&&(e.splice(0,e.length,e[i]),window.sessionStorage.setItem("menu",JSON.stringify(e)))}})}else"后台首页"==$("#top_tabs li.layui-this cite").text()&&$("#top_tabs li").length>1?$("#top_tabs li").each(function(){""==$(this).attr("lay-id")||$(this).hasClass("layui-this")||(o.tabDelete("bodyTab",$(this).attr("lay-id")).init(),window.sessionStorage.removeItem("menu"),e=[],window.sessionStorage.removeItem("curmenu"))}):a.msg("没有可以关闭的窗口了@_@");tab.tabMove()}),$(".closePageAll").on("click",function(){$("#top_tabs li").length>1?$("#top_tabs li").each(function(){""!=$(this).attr("lay-id")&&(o.tabDelete("bodyTab",$(this).attr("lay-id")).init(),window.sessionStorage.removeItem("menu"),menu=[],window.sessionStorage.removeItem("curmenu"))}):a.msg("没有可以关闭的窗口了@_@"),tab.tabMove()})});